<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   viewBox="0 0 1000 700"
   version="1.1"
   id="svg44"
   sodipodi:docname="infra.svg"
   inkscape:version="1.4.2 (ebf0e940d0, 2025-05-08)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview44"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     showgrid="false"
     inkscape:zoom="0.8356417"
     inkscape:cx="408.06963"
     inkscape:cy="262.07404"
     inkscape:window-width="1920"
     inkscape:window-height="1056"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="0"
     inkscape:current-layer="svg44" />
  <rect
     style="fill:#ffffff"
     id="rect1"
     width="1023.1658"
     height="727.58453"
     x="-9.5734806"
     y="-16.753592" />
  <rect
     x="681.59717"
     y="78.201385"
     width="248.73758"
     height="414.91895"
     fill="#e8f4fd"
     stroke="#3498db"
     stroke-width="1.36985"
     rx="2.7637506"
     id="rect45" />
  <!-- Background -->
  <!-- Title -->
  <text
     x="500"
     y="30"
     text-anchor="middle"
     font-size="20px"
     font-weight="bold"
     fill="#2c3e50"
     id="text1">Dual Tailnet Setup</text>
  <!-- NixOS Host Box -->
  <rect
     x="49.561523"
     y="79.561516"
     width="597.13885"
     height="415.14929"
     fill="#e8f4fd"
     stroke="#3498db"
     stroke-width="2.12304"
     rx="6.6348758"
     id="rect2" />
  <text
     x="57.214062"
     y="104.01646"
     font-size="16px"
     font-weight="bold"
     fill="#2c3e50"
     id="text2"><tspan
       sodipodi:role="line"
       id="tspan45"
       x="57.214062"
       y="104.01646">NixOS VM Host</tspan><tspan
       sodipodi:role="line"
       id="tspan46"
       x="57.214062"
       y="124.01646">headscale</tspan></text>
  <!-- Host Caddy -->
  <rect
     x="100"
     y="130"
     width="200"
     height="100"
     fill="#e74c3c"
     stroke="#c0392b"
     stroke-width="2"
     rx="5"
     id="rect3" />
  <text
     x="200"
     y="155"
     text-anchor="middle"
     font-size="14"
     font-weight="bold"
     fill="white"
     id="text3">Host Caddy</text>
  <text
     x="200"
     y="175"
     text-anchor="middle"
     font-size="12"
     fill="white"
     id="text4">Port 443 (HTTPS)</text>
  <text
     x="200"
     y="195"
     text-anchor="middle"
     font-size="11"
     fill="white"
     id="text5">Serves Headscale</text>
  <text
     x="200"
     y="210"
     text-anchor="middle"
     font-size="11"
     fill="white"
     id="text6">Routes to Container</text>
  <!-- Tailscale Official -->
  <rect
     x="99.882286"
     y="259.88229"
     width="200.23543"
     height="62.200977"
     fill="#9b59b6"
     stroke="#8e44ad"
     stroke-width="1.76457"
     rx="5.0058856"
     id="rect6"
     style="fill:#800080" />
  <text
     x="200"
     y="285"
     text-anchor="middle"
     font-size="14"
     font-weight="bold"
     fill="white"
     id="text7">Tailscale Client</text>
  <text
     x="200"
     y="305"
     text-anchor="middle"
     font-size="12px"
     fill="#ffffff"
     id="text8">Johannes' Tailnet</text>
  <!-- Container Box -->
  <rect
     x="399.62186"
     y="149.62184"
     width="230.04611"
     height="322.74036"
     fill="#fff3cd"
     stroke="#f39c12"
     stroke-width="1.24369"
     rx="3.8341019"
     id="rect9" />
  <text
     x="420"
     y="175"
     font-size="14"
     font-weight="bold"
     fill="#856404"
     id="text10">NixOS Container</text>
  <text
     x="420"
     y="195"
     font-size="11"
     fill="#856404"
     id="text11">IP: 192.168.100.11</text>
  <!-- Container Caddy -->
  <rect
     x="430"
     y="220"
     width="180"
     height="80"
     fill="#27ae60"
     stroke="#229954"
     stroke-width="2"
     rx="5"
     id="rect11" />
  <text
     x="520"
     y="245"
     text-anchor="middle"
     font-size="13"
     font-weight="bold"
     fill="white"
     id="text12">Container Caddy</text>
  <text
     x="520"
     y="265"
     text-anchor="middle"
     font-size="11"
     fill="white"
     id="text13">Port 80 (HTTP)</text>
  <text
     x="520"
     y="280"
     text-anchor="middle"
     font-size="11"
     fill="white"
     id="text14">Internal Services</text>
  <!-- Container Tailscale -->
  <g
     id="g55">
    <rect
       x="429.37582"
       y="391.3541"
       width="180.24443"
       height="61.557281"
       fill="#9b59b6"
       stroke="#8e44ad"
       stroke-width="1.75558"
       rx="5.0067897"
       id="rect14" />
    <g
       id="g54">
      <text
         x="519.49805"
         y="416.47632"
         text-anchor="middle"
         font-size="13px"
         font-weight="bold"
         fill="#ffffff"
         id="text15">Tailscale Client</text>
      <text
         x="519.49805"
         y="436.47632"
         text-anchor="middle"
         font-size="11px"
         fill="#ffffff"
         id="text16">Headscale Tailnet</text>
    </g>
  </g>
  <!-- Internal Services -->
  <g
     id="g51"
     transform="translate(4.6105189)">
    <rect
       x="731.90704"
       y="170.62965"
       width="120.07573"
       height="51.223927"
       fill="#6c757d"
       stroke="#495057"
       stroke-width="0.924268"
       rx="3.0018933"
       id="rect17" />
    <g
       id="g50"
       transform="translate(-0.34568024,2.5618839)">
      <text
         x="791.94489"
         y="190.66753"
         text-anchor="middle"
         font-size="12px"
         fill="#ffffff"
         id="text18">Service A</text>
      <text
         x="791.94489"
         y="205.66753"
         text-anchor="middle"
         font-size="10px"
         fill="#ffffff"
         id="text19">Port 3000</text>
    </g>
  </g>
  <g
     id="g52"
     transform="translate(3.3180994)">
    <rect
       x="733.19946"
       y="242.81635"
       width="120.07573"
       height="51.223927"
       fill="#6c757d"
       stroke="#495057"
       stroke-width="0.924268"
       rx="3.0018933"
       id="rect19" />
    <g
       id="g49">
      <text
         x="793.2666"
         y="265.41611"
         text-anchor="middle"
         font-size="12px"
         fill="#ffffff"
         id="text20">Service B</text>
      <text
         x="793.2666"
         y="280.41611"
         text-anchor="middle"
         font-size="10px"
         fill="#ffffff"
         id="text21">Port 3001</text>
    </g>
  </g>
  <g
     id="g53">
    <rect
       x="736.49969"
       y="318.14188"
       width="120.11147"
       height="47.325527"
       fill="#6c757d"
       stroke="#495057"
       stroke-width="0.888533"
       rx="3.0027866"
       id="rect21" />
    <g
       id="g48"
       transform="translate(1.1444092e-5,-7.2734547)">
      <text
         x="796.48511"
         y="346.06589"
         text-anchor="middle"
         font-size="12px"
         fill="#ffffff"
         id="text22">Service C</text>
      <text
         x="796.56519"
         y="361.06589"
         text-anchor="middle"
         font-size="10px"
         fill="#ffffff"
         id="text23">Port 3002</text>
    </g>
  </g>
  <!-- External connections -->
  <!-- Internet -->
  <ellipse
     cx="200"
     cy="50"
     rx="80"
     ry="20"
     fill="#17a2b8"
     stroke="#138496"
     stroke-width="2"
     id="ellipse23" />
  <text
     x="200"
     y="55"
     text-anchor="middle"
     font-size="12"
     font-weight="bold"
     fill="white"
     id="text24">Internet</text>
  <!-- Official Tailscale Network -->
  <g
     id="g58"
     transform="translate(172.11841,116.05699)">
    <ellipse
       cx="-29.158392"
       cy="447.51913"
       rx="60"
       ry="30"
       fill="#7b68ee"
       stroke="#6a5acd"
       stroke-width="2"
       id="ellipse24"
       style="fill:#800080" />
    <text
       x="-29.158392"
       y="442.51913"
       text-anchor="middle"
       font-size="10px"
       font-weight="bold"
       fill="#ffffff"
       id="text25">Johannes'</text>
    <text
       x="-29.158392"
       y="457.51913"
       text-anchor="middle"
       font-size="10px"
       font-weight="bold"
       fill="#ffffff"
       id="text26">Tailnet</text>
  </g>
  <!-- Headscale Network -->
  <!-- Arrows and connections -->
  <!-- Internet to Host Caddy -->
  <path
     d="M 200 70 L 200 130"
     stroke="#2c3e50"
     stroke-width="2"
     marker-end="url(#arrowhead)"
     id="path28" />
  <text
     x="210"
     y="105"
     font-size="10"
     fill="#2c3e50"
     id="text29">HTTPS:443</text>
  <!-- Host Caddy to Container Caddy -->
  <path
     d="m 300,180 122.01007,66.8928"
     stroke="#e74c3c"
     stroke-width="2"
     marker-end="url(#arrowhead)"
     id="path29"
     style="marker-end:url(#marker62)"
     sodipodi:nodetypes="cc" />
  <text
     x="320"
     y="200"
     font-size="10"
     fill="#e74c3c"
     id="text30">HTTP Proxy</text>
  <text
     x="320"
     y="215"
     font-size="10"
     fill="#e74c3c"
     id="text31">192.168.100.11:80</text>
  <!-- Container Caddy to Services -->
  <path
     d="m 609.50157,279.34579 119.66277,57.13"
     stroke="#27ae60"
     stroke-width="2"
     marker-end="url(#arrowhead)"
     id="path31"
     sodipodi:nodetypes="cc"
     style="marker-end:url(#marker59)" />
  <path
     d="m 610.48511,261.64219 118.34627,2.36529"
     stroke="#27ae60"
     stroke-width="2"
     marker-end="url(#arrowhead)"
     id="path32"
     sodipodi:nodetypes="cc"
     style="marker-end:url(#marker60)" />
  <path
     d="m 612.45217,244.92211 116.5859,-48.49117"
     stroke="#27ae60"
     stroke-width="2"
     marker-end="url(#arrowhead)"
     id="path33"
     sodipodi:nodetypes="cc"
     style="marker-end:url(#marker61)" />
  <!-- Tailscale connections -->
  <path
     d="M 150.25111,534.89457 199.05082,327.66064"
     stroke="#9b59b6"
     stroke-width="2"
     marker-end="url(#arrowhead)"
     id="path34"
     sodipodi:nodetypes="cc"
     style="marker-end:url(#marker63)" />
  <path
     d="m 705.22634,424.42812 -88.27189,0.48067"
     stroke="#9b59b6"
     stroke-width="2"
     marker-end="url(#arrowhead)"
     id="path35"
     sodipodi:nodetypes="cc"
     style="stroke-width:1.99937;stroke-dasharray:none;marker-start:url(#Triangle);marker-end:url(#marker58)" />
  <!-- Network isolation line -->
  <line
     x1="350"
     y1="150"
     x2="350"
     y2="482.13617"
     stroke="#dc3545"
     stroke-width="1.82246"
     stroke-dasharray="5, 5"
     id="line35" />
  <text
     x="355"
     y="350"
     font-size="10"
     fill="#dc3545"
     transform="rotate(90 355 350)"
     id="text35">Network Boundary</text>
  <!-- Traffic flow labels -->
  <rect
     x="255.0569"
     y="526.31964"
     width="200"
     height="80"
     fill="#f8f9fa"
     stroke="#6c757d"
     stroke-width="1"
     rx="5"
     id="rect35" />
  <text
     x="265.05688"
     y="546.31964"
     font-size="12px"
     font-weight="bold"
     fill="#2c3e50"
     id="text36">Traffic Flow:</text>
  <text
     x="265.05688"
     y="566.31964"
     font-size="10px"
     fill="#2c3e50"
     id="text37">1. Internet → Host Caddy (443)</text>
  <text
     x="265.05688"
     y="581.31964"
     font-size="10px"
     fill="#2c3e50"
     id="text38">2. Host Caddy → Container (80)</text>
  <text
     x="265.05688"
     y="596.31964"
     font-size="10px"
     fill="#2c3e50"
     id="text39">3. Container Caddy → Services</text>
  <!-- Arrow marker definition -->
  <defs
     id="defs39">
    <marker
       style="overflow:visible"
       id="marker63"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path63" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker62"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path62" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker61"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path61" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker60"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path60" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker59"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path59" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker58"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path58" />
    </marker>
    <marker
       style="overflow:visible"
       id="Triangle"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path135" />
    </marker>
    <marker
       id="arrowhead"
       markerWidth="10"
       markerHeight="7"
       refX="10"
       refY="3.5"
       orient="auto"
       viewBox="0 0 10 7"
       preserveAspectRatio="xMidYMid">
      <polygon
         points="0 0, 10 3.5, 0 7"
         fill="#2c3e50"
         id="polygon39" />
    </marker>
  </defs>
  <!-- Legend -->
  <text
     x="691.59332"
     y="105.98354"
     font-size="16px"
     font-weight="bold"
     fill="#2c3e50"
     id="text45"><tspan
       sodipodi:role="line"
       id="tspan47"
       x="691.59332"
       y="105.98354">NixOS Host</tspan><tspan
       sodipodi:role="line"
       id="tspan48"
       x="691.59332"
       y="125.98354">werkstatt-prodesk</tspan></text>
  <g
     id="g57"
     transform="translate(284.24126)">
    <rect
       x="429.37582"
       y="391.3541"
       width="180.24443"
       height="61.557281"
       fill="#9b59b6"
       stroke="#8e44ad"
       stroke-width="1.75558"
       rx="5.0067897"
       id="rect55" />
    <g
       id="g56">
      <text
         x="519.49805"
         y="416.47632"
         text-anchor="middle"
         font-size="13px"
         font-weight="bold"
         fill="#ffffff"
         id="text55">Tailscale Client</text>
      <text
         x="519.49805"
         y="436.47632"
         text-anchor="middle"
         font-size="11px"
         fill="#ffffff"
         id="text56">Headscale Tailnet</text>
    </g>
  </g>
</svg>
